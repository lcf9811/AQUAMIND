<p align="center">
  <h1 align="center">ğŸŒŠ AQUAMIND</h1>
  <p align="center">
    <strong>æ™ºèƒ½æ°´å¤„ç†å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ</strong><br>
    åŸºäº LangChain + LangGraph çš„æ±¡æ°´å¤„ç†å‚æ™ºèƒ½æ§åˆ¶å¹³å°
  </p>
  <p align="center">
    <img src="https://img.shields.io/badge/Python-3.10+-blue.svg" alt="Python">
    <img src="https://img.shields.io/badge/LangChain-1.2+-green.svg" alt="LangChain">
    <img src="https://img.shields.io/badge/LangGraph-1.0+-orange.svg" alt="LangGraph">
    <img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License">
  </p>
</p>

---

## æ¦‚è¿°

AQUAMIND æ˜¯é¢å‘æ±¡æ°´å¤„ç†å‚çš„æ™ºèƒ½æ§åˆ¶ç³»ç»Ÿï¼Œé‡‡ç”¨ **Supervisor å¤šæ™ºèƒ½ä½“æ¶æ„**ï¼Œå®ç°ï¼š

- ğŸ”„ **å®æ—¶æ•°æ®é‡‡é›†** - æ¯ 20 ç§’ä» PostgreSQL è·å– PLC æ•°æ® (15 ä¸‡+ å†å²è®°å½•)
- âš ï¸ **æ™ºèƒ½å‘Šè­¦æ£€æµ‹** - è‡ªåŠ¨ç›‘æµ‹æŠ‘åˆ¶ç‡ã€æ°¨æ°®ã€pH ç­‰å…³é”®æŒ‡æ ‡
- ğŸ¤– **å¤šæ™ºèƒ½ä½“åä½œ** - 6 ä¸ªä¸“ä¸š Agent ååŒå¤„ç†å¤æ‚ä»»åŠ¡
- ğŸ›ï¸ **MQTT è®¾å¤‡æ§åˆ¶** - ç›´æ¥ä¸‹å‘æŒ‡ä»¤æ§åˆ¶ PLC è®¾å¤‡ (38 ä¸ªå¯æ§å˜é‡)
- ğŸ“Š **ç«¯åˆ°ç«¯é—­ç¯** - æ•°æ®é‡‡é›† â†’ æ™ºèƒ½å†³ç­– â†’ è®¾å¤‡æ§åˆ¶ â†’ æ•ˆæœéªŒè¯

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AQUAMIND ç³»ç»Ÿæ¶æ„                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                         â”‚     Supervisor      â”‚                                 â”‚
â”‚                         â”‚    (LLM è°ƒåº¦å™¨)      â”‚                                 â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                    â”‚                                            â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚        â–¼           â–¼               â–¼               â–¼           â–¼           â–¼    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚ Toxicity â”‚ â”‚Turntable â”‚   â”‚   MBR    â”‚   â”‚  Regen   â”‚ â”‚Diagnosticâ”‚ â”‚ Feedback â”‚
â”‚  â”‚  Agent   â”‚ â”‚  Agent   â”‚   â”‚  Agent   â”‚   â”‚  Agent   â”‚ â”‚  Agent   â”‚ â”‚  Agent   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚       â”‚            â”‚                                                            â”‚
â”‚       â–¼            â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                           Tools Layer (20+ å·¥å…·)                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ realtime_   â”‚  â”‚ toxicity_   â”‚  â”‚ mqtt_       â”‚  â”‚ knowledge_  â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ data.py     â”‚  â”‚ predictor   â”‚  â”‚ publisher   â”‚  â”‚ query.py    â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              å¤–éƒ¨ç³»ç»Ÿ                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ PostgreSQL  â”‚    â”‚ MQTT Broker â”‚    â”‚ plc_write   â”‚    â”‚  PLC è®¾å¤‡   â”‚       â”‚
â”‚  â”‚ (è¯»å–æ•°æ®)  â”‚â—„â”€â”€â”€â”‚ (1883)      â”‚â”€â”€â”€â–ºâ”‚ _handler    â”‚â”€â”€â”€â–ºâ”‚  (æ§åˆ¶)     â”‚       â”‚
â”‚  â”‚ 155K+ è®°å½•  â”‚    â”‚             â”‚    â”‚ (æœåŠ¡å™¨)    â”‚    â”‚  267 å˜é‡   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒåŠŸèƒ½

### 1. æ™ºèƒ½ä½“ (6 ä¸ªä¸“ä¸š Agent)

| Agent | èŒè´£ | å·¥å…· |
|-------|------|------|
| **Toxicity** | æ¯’æ€§é¢„æµ‹ä¸å‘Šè­¦ | realtime_data, toxicity_predictor |
| **Turntable** | è½¬ç›˜é¢‘ç‡æ§åˆ¶ | mqtt_publisher, plc_commands |
| **MBR** | è†œç³»ç»Ÿç®¡ç† | plc_commands |
| **Regeneration** | æ´»æ€§ç‚­å†ç”Ÿ | plc_commands |
| **Diagnostic** | æ•…éšœè¯Šæ–­ | knowledge_query |
| **Feedback** | ç­–ç•¥ä¼˜åŒ– | - |

### 2. å·¥å…·æ¨¡å— (20+ å·¥å…·å‡½æ•°)

#### å®æ—¶æ•°æ®é‡‡é›†
```python
from aquamind.tools import get_latest_plc_from_db, get_inhibition_trend

# è·å–æœ€æ–° PLC æ•°æ®
data = get_latest_plc_from_db.invoke({})
# â†’ {"inlet_inhibition_ratio": 34.96, "outlet_ph": 5.81, ...}

# æŸ¥è¯¢ 6 å°æ—¶è¶‹åŠ¿
trend = get_inhibition_trend.invoke({"hours": 6})
```

#### å‘Šè­¦æ£€æµ‹
```python
from aquamind.tools import check_toxicity_alert

alert = check_toxicity_alert.invoke({})
# â†’ {"alert_status": "warning", "alerts": [{"message": "å‡ºæ°´ pH è¿‡ä½"}]}
```

#### MQTT è®¾å¤‡æ§åˆ¶
```python
from aquamind.tools import set_turntable_frequency, control_valve

# è®¾ç½®è½¬ç›˜é¢‘ç‡
set_turntable_frequency.invoke({"turntable_id": 1, "frequency": 35})

# æ§åˆ¶é˜€é—¨
control_valve.invoke({"valve_id": "VA01", "action": "open"})
```

### 3. å¯æ§è£…ç½® (38 ä¸ªå˜é‡)

| ç±»åˆ« | å˜é‡ | æ•°é‡ |
|------|------|------|
| è½¬ç›˜ | å¯åœ + é¢‘ç‡ (5-50Hz) | 6 |
| é˜€é—¨ | VA01-VA14 | 14 |
| æ³µ | B01-B06 | 6 |
| åŠ çƒ­æ£’ | HT00-HT03 | 4 |
| å†ç”Ÿç³»ç»Ÿ | 1/2/3 | 3 |
| é£æœº | å¯åœ | 1 |
| ä¸€é”®å¯åŠ¨ | ç³»ç»Ÿå¯åŠ¨ | 1 |
| çº¿è·¯é€‰æ‹© | 1/2/3 å·çº¿è·¯ | 3 |

### 4. å‘Šè­¦é˜ˆå€¼

| æŒ‡æ ‡ | è­¦å‘Š | ä¸¥é‡ | å•ä½ |
|------|------|------|------|
| è¿›æ°´æŠ‘åˆ¶ç‡ | â‰¥ 40 | â‰¥ 50 | % |
| å‡ºæ°´æŠ‘åˆ¶ç‡ | â‰¥ 5 | â‰¥ 10 | % |
| å‡ºæ°´æ°¨æ°® | â‰¥ 1.5 | â‰¥ 2.0 | mg/L |
| å‡ºæ°´ pH | < 6.0 æˆ– > 8.5 | - | - |

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…

```bash
git clone https://github.com/Water-Quality-Risk-Control-Engineering/Aquamind.git
cd AQUAMIND
pip install -r requirements.txt
```

### 2. é…ç½®

```bash
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥ API å¯†é’¥å’Œæ•°æ®åº“é…ç½®
```

å¿…éœ€é…ç½®é¡¹ï¼š
```env
# LLM API
API_BASE=https://dashscope.aliyuncs.com/compatible-mode/v1
API_KEY=your_api_key
MODEL_NAME=qwen-plus
```

### 3. è¿è¡Œ

```bash
# äº¤äº’å¼å¯¹è¯
python -m aquamind

# å•æ¬¡æŸ¥è¯¢
python -m aquamind -q "æ£€æŸ¥å½“å‰å‘Šè­¦çŠ¶æ€"

# æŸ¥çœ‹å¸®åŠ©
python -m aquamind --help
```

## ä½¿ç”¨ç¤ºä¾‹

### Python API

```python
from aquamind import AquamindSupervisor

# åˆ›å»º Supervisor
supervisor = AquamindSupervisor()

# æ™ºèƒ½å¯¹è¯
response = supervisor.chat("å½“å‰æ¯’æ€§æƒ…å†µå¦‚ä½•ï¼Ÿéœ€è¦è°ƒæ•´è½¬ç›˜é¢‘ç‡å—ï¼Ÿ")
print(response)
```

### ç›´æ¥ä½¿ç”¨å·¥å…·

```python
from aquamind.tools import (
    get_latest_plc_from_db,
    check_toxicity_alert,
    set_turntable_frequency,
)

# 1. è·å–å®æ—¶æ•°æ®
data = get_latest_plc_from_db.invoke({})

# 2. æ£€æŸ¥å‘Šè­¦
alert = check_toxicity_alert.invoke({})

# 3. æ§åˆ¶è®¾å¤‡
if alert["alert_status"] == "warning":
    set_turntable_frequency.invoke({"turntable_id": 1, "frequency": 40})
```

## é¡¹ç›®ç»“æ„

```
AQUAMIND/
â”œâ”€â”€ aquamind/
â”‚   â”œâ”€â”€ __init__.py              # åŒ…å…¥å£
â”‚   â”œâ”€â”€ __main__.py              # CLI å…¥å£
â”‚   â”œâ”€â”€ agents/                  # æ™ºèƒ½ä½“
â”‚   â”‚   â”œâ”€â”€ supervisor.py        # ä¸»åè°ƒå™¨ (Supervisor)
â”‚   â”‚   â”œâ”€â”€ toxicity.py          # æ¯’æ€§é¢„æµ‹ Agent
â”‚   â”‚   â”œâ”€â”€ turntable.py         # è½¬ç›˜æ§åˆ¶ Agent (å« MQTT)
â”‚   â”‚   â”œâ”€â”€ mbr.py               # MBR è†œç³»ç»Ÿ Agent
â”‚   â”‚   â”œâ”€â”€ regeneration.py      # æ´»æ€§ç‚­å†ç”Ÿ Agent
â”‚   â”‚   â”œâ”€â”€ diagnostic.py        # ç³»ç»Ÿè¯Šæ–­ Agent
â”‚   â”‚   â””â”€â”€ feedback.py          # åé¦ˆä¼˜åŒ– Agent
â”‚   â”œâ”€â”€ tools/                   # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ realtime_data.py     # å®æ—¶æ•°æ®é‡‡é›† (PostgreSQL)
â”‚   â”‚   â”œâ”€â”€ mqtt_publisher.py    # MQTT è®¾å¤‡æ§åˆ¶
â”‚   â”‚   â”œâ”€â”€ toxicity_predictor.py # æ¯’æ€§é¢„æµ‹ + å‘Šè­¦
â”‚   â”‚   â”œâ”€â”€ plc_commands.py      # PLC æŒ‡ä»¤ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ knowledge_query.py   # çŸ¥è¯†åº“æŸ¥è¯¢
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ llm.py               # LLM æ¥å£
â”‚   â”‚   â””â”€â”€ logger.py            # æ—¥å¿—ç³»ç»Ÿ
â”‚   â””â”€â”€ knowledge/               # çŸ¥è¯†åº“
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ plc_write_handler.py     # æœåŠ¡å™¨ç«¯ MQTT è®¢é˜…ç¨‹åº
â”œâ”€â”€ data/                        # æ•°æ®æ–‡ä»¶
â”œâ”€â”€ docs/                        # æ–‡æ¡£
â”œâ”€â”€ .env.example                 # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ requirements.txt             # ä¾èµ–
â””â”€â”€ README.md
```

## æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| å¤šæ™ºèƒ½ä½“æ¡†æ¶ | LangGraph | â‰¥ 1.0.0 |
| LLM ç¼–æ’ | LangChain | â‰¥ 1.2.0 |
| é…ç½®ç®¡ç† | Pydantic Settings | â‰¥ 2.10.0 |
| æ•°æ®å¤„ç† | Pandas / NumPy | â‰¥ 2.0.0 |
| æ•°æ®åº“ | psycopg2 | â‰¥ 2.9.0 |
| æ¶ˆæ¯é˜Ÿåˆ— | paho-mqtt | â‰¥ 2.0.0 |

## æœåŠ¡å™¨éƒ¨ç½²

### plc_write_handler (MQTT è®¢é˜…è½¬å‘)

```bash
# å¯åŠ¨
cd /root/MQTT_test && nohup python3 plc_write_handler.py > /dev/null 2>&1 &

# æŸ¥çœ‹æ—¥å¿—
tail -f /root/MQTT_test/plc_write.log

# åœæ­¢
pkill -f plc_write_handler
```

## æ•°æ®è§„æ¨¡

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| PLC å˜é‡æ˜ å°„ | 267 ä¸ª |
| æ•°æ®åº“å­—æ®µ | 51 ä¸ª |
| å†å²è®°å½• | 155,000+ æ¡ |
| é‡‡æ ·é¢‘ç‡ | æ¯ 20 ç§’ |
| æ•°æ®è·¨åº¦ | ~2 ä¸ªæœˆ |

## License

[MIT](LICENSE)

---

<p align="center">
  <sub>Built with â¤ï¸ for wastewater treatment intelligence</sub>
</p>
